function sq_molecule_dendrimer(qx) result(val)
implicit none
  double precision, intent(in) :: qx
  double precision             :: val

!! Table of SQ created by sldreader_production1.f90 (DENDRIMER/WRITEUP/LIT/MOLPARAM/..)
integer, parameter           :: mq =     300
double precision, parameter  :: q(0:mq) = [  &
 0.000000000, &
 0.005000000, &
 0.010000000, &
 0.015000000, &
 0.020000000, &
 0.025000000, &
 0.030000000, &
 0.035000000, &
 0.040000000, &
 0.045000000, &
 0.050000000, &
 0.055000000, &
 0.060000000, &
 0.065000000, &
 0.070000000, &
 0.075000000, &
 0.080000000, &
 0.085000000, &
 0.090000000, &
 0.095000000, &
 0.100000000, &
 0.105000000, &
 0.110000000, &
 0.115000000, &
 0.120000000, &
 0.125000000, &
 0.130000000, &
 0.135000000, &
 0.140000000, &
 0.145000000, &
 0.150000000, &
 0.155000000, &
 0.160000000, &
 0.165000000, &
 0.170000000, &
 0.175000000, &
 0.180000000, &
 0.185000000, &
 0.190000000, &
 0.195000000, &
 0.200000000, &
 0.205000000, &
 0.210000000, &
 0.215000000, &
 0.220000000, &
 0.225000000, &
 0.230000000, &
 0.235000000, &
 0.240000000, &
 0.245000000, &
 0.250000000, &
 0.255000000, &
 0.260000000, &
 0.265000000, &
 0.270000000, &
 0.275000000, &
 0.280000000, &
 0.285000000, &
 0.290000000, &
 0.295000000, &
 0.300000000, &
 0.305000000, &
 0.310000000, &
 0.315000000, &
 0.320000000, &
 0.325000000, &
 0.330000000, &
 0.335000000, &
 0.340000000, &
 0.345000000, &
 0.350000000, &
 0.355000000, &
 0.360000000, &
 0.365000000, &
 0.370000000, &
 0.375000000, &
 0.380000000, &
 0.385000000, &
 0.390000000, &
 0.395000000, &
 0.400000000, &
 0.405000000, &
 0.410000000, &
 0.415000000, &
 0.420000000, &
 0.425000000, &
 0.430000000, &
 0.435000000, &
 0.440000000, &
 0.445000000, &
 0.450000000, &
 0.455000000, &
 0.460000000, &
 0.465000000, &
 0.470000000, &
 0.475000000, &
 0.480000000, &
 0.485000000, &
 0.490000000, &
 0.495000000, &
 0.500000000, &
 0.505000000, &
 0.510000000, &
 0.515000000, &
 0.520000000, &
 0.525000000, &
 0.530000000, &
 0.535000000, &
 0.540000000, &
 0.545000000, &
 0.550000000, &
 0.555000000, &
 0.560000000, &
 0.565000000, &
 0.570000000, &
 0.575000000, &
 0.580000000, &
 0.585000000, &
 0.590000000, &
 0.595000000, &
 0.600000000, &
 0.605000000, &
 0.610000000, &
 0.615000000, &
 0.620000000, &
 0.625000000, &
 0.630000000, &
 0.635000000, &
 0.640000000, &
 0.645000000, &
 0.650000000, &
 0.655000000, &
 0.660000000, &
 0.665000000, &
 0.670000000, &
 0.675000000, &
 0.680000000, &
 0.685000000, &
 0.690000000, &
 0.695000000, &
 0.700000000, &
 0.705000000, &
 0.710000000, &
 0.715000000, &
 0.720000000, &
 0.725000000, &
 0.730000000, &
 0.735000000, &
 0.740000000, &
 0.745000000, &
 0.750000000, &
 0.755000000, &
 0.760000000, &
 0.765000000, &
 0.770000000, &
 0.775000000, &
 0.780000000, &
 0.785000000, &
 0.790000000, &
 0.795000000, &
 0.800000000, &
 0.805000000, &
 0.810000000, &
 0.815000000, &
 0.820000000, &
 0.825000000, &
 0.830000000, &
 0.835000000, &
 0.840000000, &
 0.845000000, &
 0.850000000, &
 0.855000000, &
 0.860000000, &
 0.865000000, &
 0.870000000, &
 0.875000000, &
 0.880000000, &
 0.885000000, &
 0.890000000, &
 0.895000000, &
 0.900000000, &
 0.905000000, &
 0.910000000, &
 0.915000000, &
 0.920000000, &
 0.925000000, &
 0.930000000, &
 0.935000000, &
 0.940000000, &
 0.945000000, &
 0.950000000, &
 0.955000000, &
 0.960000000, &
 0.965000000, &
 0.970000000, &
 0.975000000, &
 0.980000000, &
 0.985000000, &
 0.990000000, &
 0.995000000, &
 1.000000000, &
 1.005000000, &
 1.010000000, &
 1.015000000, &
 1.020000000, &
 1.025000000, &
 1.030000000, &
 1.035000000, &
 1.040000000, &
 1.045000000, &
 1.050000000, &
 1.055000000, &
 1.060000000, &
 1.065000000, &
 1.070000000, &
 1.075000000, &
 1.080000000, &
 1.085000000, &
 1.090000000, &
 1.095000000, &
 1.100000000, &
 1.105000000, &
 1.110000000, &
 1.115000000, &
 1.120000000, &
 1.125000000, &
 1.130000000, &
 1.135000000, &
 1.140000000, &
 1.145000000, &
 1.150000000, &
 1.155000000, &
 1.160000000, &
 1.165000000, &
 1.170000000, &
 1.175000000, &
 1.180000000, &
 1.185000000, &
 1.190000000, &
 1.195000000, &
 1.200000000, &
 1.205000000, &
 1.210000000, &
 1.215000000, &
 1.220000000, &
 1.225000000, &
 1.230000000, &
 1.235000000, &
 1.240000000, &
 1.245000000, &
 1.250000000, &
 1.255000000, &
 1.260000000, &
 1.265000000, &
 1.270000000, &
 1.275000000, &
 1.280000000, &
 1.285000000, &
 1.290000000, &
 1.295000000, &
 1.300000000, &
 1.305000000, &
 1.310000000, &
 1.315000000, &
 1.320000000, &
 1.325000000, &
 1.330000000, &
 1.335000000, &
 1.340000000, &
 1.345000000, &
 1.350000000, &
 1.355000000, &
 1.360000000, &
 1.365000000, &
 1.370000000, &
 1.375000000, &
 1.380000000, &
 1.385000000, &
 1.390000000, &
 1.395000000, &
 1.400000000, &
 1.405000000, &
 1.410000000, &
 1.415000000, &
 1.420000000, &
 1.425000000, &
 1.430000000, &
 1.435000000, &
 1.440000000, &
 1.445000000, &
 1.450000000, &
 1.455000000, &
 1.460000000, &
 1.465000000, &
 1.470000000, &
 1.475000000, &
 1.480000000, &
 1.485000000, &
 1.490000000, &
 1.495000000, &
 1.500000000 ]
double precision, parameter  ::sq(0:mq) = [  &
 1.000000000, &
 0.999757585, &
 0.999030689, &
 0.997820355, &
 0.996128320, &
 0.993957011, &
 0.991309539, &
 0.988189690, &
 0.984601920, &
 0.980551343, &
 0.976043722, &
 0.971085450, &
 0.965683543, &
 0.959845622, &
 0.953579893, &
 0.946895132, &
 0.939800665, &
 0.932306350, &
 0.924422548, &
 0.916160110, &
 0.907530346, &
 0.898545005, &
 0.889216246, &
 0.879556616, &
 0.869579020, &
 0.859296697, &
 0.848723187, &
 0.837872309, &
 0.826758129, &
 0.815394928, &
 0.803797181, &
 0.791979518, &
 0.779956703, &
 0.767743600, &
 0.755355144, &
 0.742806313, &
 0.730112100, &
 0.717287482, &
 0.704347393, &
 0.691306696, &
 0.678180159, &
 0.664982423, &
 0.651727979, &
 0.638431143, &
 0.625106031, &
 0.611766535, &
 0.598426302, &
 0.585098709, &
 0.571796847, &
 0.558533494, &
 0.545321104, &
 0.532171784, &
 0.519097281, &
 0.506108962, &
 0.493217805, &
 0.480434382, &
 0.467768849, &
 0.455230936, &
 0.442829934, &
 0.430574691, &
 0.418473604, &
 0.406534609, &
 0.394765184, &
 0.383172338, &
 0.371762615, &
 0.360542088, &
 0.349516364, &
 0.338690579, &
 0.328069406, &
 0.317657058, &
 0.307457288, &
 0.297473399, &
 0.287708246, &
 0.278164250, &
 0.268843400, &
 0.259747262, &
 0.250876995, &
 0.242233356, &
 0.233816711, &
 0.225627051, &
 0.217664001, &
 0.209926835, &
 0.202414487, &
 0.195125570, &
 0.188058383, &
 0.181210933, &
 0.174580944, &
 0.168165879, &
 0.161962946, &
 0.155969123, &
 0.150181167, &
 0.144595635, &
 0.139208892, &
 0.134017136, &
 0.129016406, &
 0.124202601, &
 0.119571493, &
 0.115118746, &
 0.110839924, &
 0.106730512, &
 0.102785925, &
 0.099001525, &
 0.095372633, &
 0.091894541, &
 0.088562525, &
 0.085371858, &
 0.082317821, &
 0.079395712, &
 0.076600859, &
 0.073928627, &
 0.071374431, &
 0.068933743, &
 0.066602097, &
 0.064375102, &
 0.062248448, &
 0.060217908, &
 0.058279349, &
 0.056428736, &
 0.054662134, &
 0.052975717, &
 0.051365768, &
 0.049828684, &
 0.048360978, &
 0.046959281, &
 0.045620344, &
 0.044341041, &
 0.043118365, &
 0.041949433, &
 0.040831485, &
 0.039761881, &
 0.038738102, &
 0.037757750, &
 0.036818544, &
 0.035918319, &
 0.035055024, &
 0.034226721, &
 0.033431579, &
 0.032667873, &
 0.031933983, &
 0.031228387, &
 0.030549659, &
 0.029896467, &
 0.029267566, &
 0.028661798, &
 0.028078087, &
 0.027515432, &
 0.026972908, &
 0.026449659, &
 0.025944895, &
 0.025457887, &
 0.024987965, &
 0.024534513, &
 0.024096967, &
 0.023674808, &
 0.023267560, &
 0.022874788, &
 0.022496095, &
 0.022131113, &
 0.021779509, &
 0.021440973, &
 0.021115221, &
 0.020801991, &
 0.020501039, &
 0.020212138, &
 0.019935076, &
 0.019669652, &
 0.019415674, &
 0.019172962, &
 0.018941339, &
 0.018720635, &
 0.018510684, &
 0.018311322, &
 0.018122386, &
 0.017943714, &
 0.017775144, &
 0.017616513, &
 0.017467655, &
 0.017328403, &
 0.017198588, &
 0.017078036, &
 0.016966574, &
 0.016864022, &
 0.016770199, &
 0.016684920, &
 0.016607999, &
 0.016539244, &
 0.016478464, &
 0.016425464, &
 0.016380047, &
 0.016342016, &
 0.016311170, &
 0.016287310, &
 0.016270235, &
 0.016259745, &
 0.016255639, &
 0.016257719, &
 0.016265786, &
 0.016279644, &
 0.016299099, &
 0.016323958, &
 0.016354033, &
 0.016389136, &
 0.016429085, &
 0.016473699, &
 0.016522804, &
 0.016576226, &
 0.016633799, &
 0.016695357, &
 0.016760742, &
 0.016829799, &
 0.016902376, &
 0.016978328, &
 0.017057510, &
 0.017139787, &
 0.017225023, &
 0.017313088, &
 0.017403856, &
 0.017497205, &
 0.017593015, &
 0.017691169, &
 0.017791555, &
 0.017894062, &
 0.017998581, &
 0.018105005, &
 0.018213232, &
 0.018323156, &
 0.018434677, &
 0.018547693, &
 0.018662104, &
 0.018777810, &
 0.018894710, &
 0.019012704, &
 0.019131690, &
 0.019251567, &
 0.019372232, &
 0.019493580, &
 0.019615506, &
 0.019737902, &
 0.019860660, &
 0.019983667, &
 0.020106811, &
 0.020229976, &
 0.020353046, &
 0.020475899, &
 0.020598416, &
 0.020720470, &
 0.020841937, &
 0.020962687, &
 0.021082591, &
 0.021201516, &
 0.021319329, &
 0.021435894, &
 0.021551074, &
 0.021664732, &
 0.021776728, &
 0.021886924, &
 0.021995180, &
 0.022101356, &
 0.022205312, &
 0.022306910, &
 0.022406012, &
 0.022502479, &
 0.022596178, &
 0.022686973, &
 0.022774735, &
 0.022859334, &
 0.022940644, &
 0.023018543, &
 0.023092912, &
 0.023163635, &
 0.023230601, &
 0.023293704, &
 0.023352843, &
 0.023407920, &
 0.023458846, &
 0.023505535, &
 0.023547907, &
 0.023585889, &
 0.023619413, &
 0.023648421, &
 0.023672857, &
 0.023692676, &
 0.023707836, &
 0.023718306, &
 0.023724059, &
 0.023725077, &
 0.023721348, &
 0.023712869, &
 0.023699643, &
 0.023681679, &
 0.023658996, &
 0.023631617, &
 0.023599574, &
 0.023562905, &
 0.023521656, &
 0.023475877, &
 0.023425626, &
 0.023370967, &
 0.023311970, &
 0.023248710, &
 0.023181268 ]
double precision :: boffs       =    0.000000
integer          :: ncenters    =      51
integer          :: nsolvent0   =      51
integer          :: Nacc        =   51485
double precision :: sld_solvent =    0.638000
double precision :: R_solvent   =    0.700000
double precision :: molecule_volume =  611.262224
double precision :: solvent_volume  = 1103.658972
double precision :: btotal_molecule =   63.068649
double precision :: sld_molecule    =    0.103178
double precision :: boxlim(3,2) 


integer          :: ix
double precision :: p



boxlim(:,1) = [  -10.178974,   -5.551100,   -4.183700]
boxlim(:,2) = [    6.212100,    6.426200,    4.551600]

ix  = minloc(abs(qx-q(:)), dim=1)-1
val = sq(ix)
if(ix >= mq) return

p = (qx-q(ix))/(q(ix+1)-q(ix))

val = sq(ix)*(1d0-p) + p * sq(ix+1)

end function sq_molecule_dendrimer
